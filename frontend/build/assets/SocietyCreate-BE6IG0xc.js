import{r as l,j as e}from"./index-BOQoDeiJ.js";import{g as T,a as B,b as I,c as U}from"./SocietyService-CGeiqU4x.js";import{C as o,a}from"./CRow-DZKMKKzZ.js";import{C as Z,a as H}from"./CCardBody-Dm0V9Iwv.js";import{C as O}from"./CCardHeader-C3St3R9K.js";import{C as k}from"./CForm-BmkLFAKO.js";import{a as c,C as i}from"./CFormInput-kvLYk_aa.js";import{C as u}from"./CFormSelect-B18wGbu2.js";import{C as G}from"./CImage-HSBO8RvM.js";import{a as J}from"./index.esm-BDIoaTPO.js";import{C as b}from"./CAlert-Bm5RWCiZ.js";import"./cil-user-CBnTYt-8.js";const ae=()=>{const[r,m]=l.useState({name:"",street:"",locality:"",city:"",state:"",country:"",zipCode:"",establishment:"",type:"",logo:null,registrationNumber:""}),[j,x]=l.useState(null),[S,y]=l.useState(!1),[p,C]=l.useState(null),[N,v]=l.useState([]),[F,g]=l.useState([]),[E,f]=l.useState([]),[d,L]=l.useState(""),[h,w]=l.useState(""),[K,R]=l.useState("");l.useEffect(()=>{(async()=>{try{const t=await T();t.code===200&&!t.error?v(t.results):console.error("Error fetching countries:",t.message)}catch(t){console.error("Error fetching countries:",t)}})()},[]),l.useEffect(()=>{(async()=>{if(d)try{const t=await B(d);t.code===200&&!t.error?g(t.results):console.error("Error fetching states:",t.message)}catch(t){console.error("Error fetching states:",t)}else g([])})()},[d]),l.useEffect(()=>{(async()=>{if(h)try{const t=await I(h);t.code===200&&!t.error?f(t.results):console.error("Error fetching city:",t.message)}catch(t){console.error("Error fetching city:",t)}else f([])})()},[h]);const n=s=>{m({...r,[s.target.name]:s.target.value})},z=s=>{L(s.target.value),m({...r,[s.target.name]:s.target.value})},D=s=>{w(s.target.value),m({...r,[s.target.name]:s.target.value})},q=s=>{R(s.target.value),m({...r,[s.target.name]:s.target.value})},A=s=>{const t=s.target.files[0];m({...r,logo:t}),C(URL.createObjectURL(t))},P=async s=>{s.preventDefault(),x(null),y(!1);try{const t=await U(r);t.code===200&&!t.error?(y(!0),m({name:"",street:"",locality:"",city:"",state:"",country:"",zipCode:"",establishment:"",type:"",logo:null,registrationNumber:""}),C(null)):x(t.message)}catch{x("Failed to create society. Please try again.")}};return e.jsx(o,{children:e.jsx(a,{xs:12,children:e.jsxs(Z,{className:"mb-4",children:[e.jsx(O,{children:e.jsx("strong",{children:"Create Society"})}),e.jsxs(H,{children:[e.jsxs(k,{onSubmit:P,children:[e.jsxs(o,{className:"mb-3",children:[e.jsx(c,{htmlFor:"name",className:"col-sm-2 col-form-label",children:"Society Name"}),e.jsx(a,{sm:10,children:e.jsx(i,{type:"text",id:"name",name:"name",placeholder:"Society Name",value:r.fname,onChange:n,required:!0})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(c,{htmlFor:"street",className:"col-sm-2 col-form-label",children:"Address Line 1"}),e.jsx(a,{sm:10,children:e.jsx(i,{type:"text",id:"street",name:"street",value:r.street,placeholder:"Address Line 1",onChange:n,required:!0})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(c,{htmlFor:"locality",className:"col-sm-2 col-form-label",children:"Locality"}),e.jsx(a,{sm:10,children:e.jsx(i,{type:"text",id:"locality",name:"locality",value:r.locality,placeholder:"Locality",onChange:n,required:!0})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(c,{htmlFor:"country",className:"col-sm-2 col-form-label",children:"Country"}),e.jsx(a,{sm:10,children:e.jsxs(u,{id:"country",name:"country",value:r.country,onChange:z,children:[e.jsx("option",{value:"",children:"Select Country"}),N.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(c,{htmlFor:"state",className:"col-sm-2 col-form-label",children:"State"}),e.jsx(a,{sm:10,children:e.jsxs(u,{id:"state",name:"state",value:r.state,onChange:D,disabled:!d,children:[e.jsx("option",{value:"",children:"Select State"}),F.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(c,{htmlFor:"city",className:"col-sm-2 col-form-label",children:"City"}),e.jsx(a,{sm:10,children:e.jsxs(u,{id:"city",name:"city",value:r.city,onChange:q,disabled:!h,children:[e.jsx("option",{value:"",children:"Select City"}),E.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(c,{htmlFor:"zipCode",className:"col-sm-2 col-form-label",children:"Zip code"}),e.jsx(a,{sm:10,children:e.jsx(i,{type:"tel",id:"zipCode",name:"zipCode",placeholder:"Zip Code",value:r.zipCode,onChange:n,required:!0})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(c,{htmlFor:"establishment",className:"col-sm-2 col-form-label",children:"Establishment Date"}),e.jsx(a,{sm:10,children:e.jsx(i,{type:"Date",id:"establishment",name:"establishment",placeholder:"Establishment Date",value:r.establishment,onChange:n})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(c,{htmlFor:"type",className:"col-sm-2 col-form-label",children:"Society Type"}),e.jsx(a,{sm:10,children:e.jsxs(u,{id:"type",name:"type",value:r.type,onChange:n,children:[e.jsx("option",{value:"",children:"Select Society Type"}),e.jsx("option",{value:"1",children:"Tenament"},"1"),e.jsx("option",{value:"2",children:"Flat"},"2")]})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(c,{htmlFor:"registrationNumber",className:"col-sm-2 col-form-label",children:"Registration Number"}),e.jsx(a,{sm:10,children:e.jsx(i,{type:"text",id:"registrationNumber",name:"registrationNumber",placeholder:"Registration Number",value:r.registrationNumber,onChange:n})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(c,{htmlFor:"logo",className:"col-sm-2 col-form-label",children:"Logo"}),e.jsx(a,{sm:10,children:e.jsx(i,{type:"file",id:"logo",name:"logo",onChange:A,accept:"image/*"})})]}),p&&e.jsxs(o,{className:"mb-3",children:[e.jsx(a,{sm:2}),e.jsx(a,{sm:10,children:e.jsx(G,{src:p,alt:"Logo Preview",width:200,className:"mb-2"})})]}),e.jsx(J,{type:"submit",color:"primary",children:"Submit"})]}),j&&e.jsx(b,{color:"danger",className:"mt-3",children:j}),S&&e.jsx(b,{color:"success",className:"mt-3",children:"Society created successfully!"})]})]})})})};export{ae as default};
