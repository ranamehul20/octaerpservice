import{v as F,r,j as s}from"./index-BOQoDeiJ.js";import{v as B,g as E,u as H}from"./BlockService-CCfFz_sy.js";import{C as c,a as l}from"./CRow-DZKMKKzZ.js";import{C as I,a as k}from"./CCardBody-Dm0V9Iwv.js";import{C as q}from"./CCardHeader-C3St3R9K.js";import{C as w}from"./CForm-BmkLFAKO.js";import{a as m,C as p}from"./CFormInput-kvLYk_aa.js";import{C as R}from"./CFormSelect-B18wGbu2.js";import{a as D}from"./index.esm-BDIoaTPO.js";import{C as j}from"./CAlert-Bm5RWCiZ.js";import"./cil-user-CBnTYt-8.js";const Q=()=>{const{id:i}=F(),[t,d]=r.useState({name:"",totalHouse:"",societyId:""}),[u,n]=r.useState(null),[C,h]=r.useState(!1),[y,S]=r.useState([]),[_,f]=r.useState(""),g=async()=>{try{const e=await B(i);if(e.code===200&&!e.error){const o=e.results;Object.keys(t).forEach(a=>{t[a]=o[a],a==="societyId"&&(t[a]=o[a]._id)}),f(o.societyId._id)}}catch(e){console.error("Failed to fetch block details:",e)}},b=async()=>{try{const e=await E();e.code===200&&!e.error?S(e.results):console.error("Error fetching societies:",e.error)}catch(e){console.error("Error fetching societies:",e)}};r.useEffect(()=>{b(),g()},[i]);const x=e=>{d({...t,[e.target.name]:e.target.value})},v=e=>{f(e.target.value),d({...t,[e.target.name]:e.target.value})},N=async e=>{e.preventDefault(),n(null),h(!1);try{const o=await H(i,t);o.code===200&&!o.error?h(!0):n(o.message)}catch{n("Failed to create block. Please try again.")}};return s.jsx(c,{children:s.jsx(l,{xs:12,children:s.jsxs(I,{className:"mb-4",children:[s.jsx(q,{children:s.jsx("strong",{children:"Edit Block"})}),s.jsxs(k,{children:[s.jsxs(w,{onSubmit:N,children:[s.jsxs(c,{className:"mb-3",children:[s.jsx(m,{htmlFor:"name",className:"col-sm-2 col-form-label",children:"Block Name"}),s.jsx(l,{sm:10,children:s.jsx(p,{type:"text",id:"name",name:"name",placeholder:"Block Name",value:t.name,onChange:x,required:!0})})]}),s.jsxs(c,{className:"mb-3",children:[s.jsx(m,{htmlFor:"totalHouse",className:"col-sm-2 col-form-label",children:"Total House"}),s.jsx(l,{sm:10,children:s.jsx(p,{type:"text",id:"totalHouse",name:"totalHouse",value:t.totalHouse,placeholder:"Total House",onChange:x,required:!0})})]}),s.jsxs(c,{className:"mb-3",children:[s.jsx(m,{htmlFor:"societyId",className:"col-sm-2 col-form-label",children:"Society"}),s.jsx(l,{sm:10,children:s.jsxs(R,{id:"societyId",name:"societyId",value:t.societyId,onChange:v,children:[s.jsx("option",{value:"",children:"Select Society"}),y.map(e=>s.jsx("option",{value:e._id,children:e.name},e._id))]})})]}),s.jsx(D,{type:"submit",color:"primary",children:"Submit"})]}),u&&s.jsx(j,{color:"danger",className:"mt-3",children:u}),C&&s.jsx(j,{color:"success",className:"mt-3",children:"Block created successfully!"})]})]})})})};export{Q as default};
