import{r as a,j as e,w as h}from"./index-BOQoDeiJ.js";import{C as r,a as o}from"./CRow-DZKMKKzZ.js";import{C as F,a as A}from"./CCardBody-Dm0V9Iwv.js";import{C as E}from"./CCardHeader-C3St3R9K.js";import{C as M}from"./CForm-BmkLFAKO.js";import{a as c,C as n}from"./CFormInput-kvLYk_aa.js";import{C as j}from"./CFormSelect-B18wGbu2.js";import{a as w}from"./index.esm-BDIoaTPO.js";import{C}from"./CAlert-Bm5RWCiZ.js";import"./cil-user-CBnTYt-8.js";const J=()=>{const[l,d]=a.useState({name:"",type:"",totalMembers:0,totalChildren:0,totalAdults:0,blockId:"",societyId:""}),[u,x]=a.useState(null),[b,p]=a.useState(!1),[f,y]=a.useState([]),[m,g]=a.useState(""),[S,N]=a.useState([]),[H,k]=a.useState("");a.useEffect(()=>{(async()=>{try{const s=await h.get("http://localhost:3001/api/config/societies",{withCredentials:!0});s.data.code===200&&!s.data.error?y(s.data.results):console.error("Error fetching societies:",s.data.error)}catch(s){console.error("Error fetching societies:",s)}})()},[]),a.useEffect(()=>{(async()=>{if(m)try{const s=await h.get("http://localhost:3001/api/blocks?societyId="+m,{withCredentials:!0});s.data.code===200&&!s.data.error?N(s.data.results):console.error("Error fetching blocks:",s.data.error)}catch(s){console.error("Error fetching blocks:",s)}})()},[m]);const i=t=>{d({...l,[t.target.name]:t.target.value})},v=t=>{g(t.target.value),d({...l,[t.target.name]:t.target.value})},I=t=>{k(t.target.value),d({...l,[t.target.name]:t.target.value})},B=async t=>{t.preventDefault(),x(null),p(!1);try{await h.post("http://localhost:3001/api/houses",l,{withCredentials:!0}),p(!0),d({name:"",type:"",totalMembers:0,totalChildren:0,totalAdults:0,blockId:"",societyId:""})}catch{x("Failed to create house. Please try again.")}};return e.jsx(r,{children:e.jsx(o,{xs:12,children:e.jsxs(F,{className:"mb-4",children:[e.jsx(E,{children:e.jsx("strong",{children:"Create House"})}),e.jsxs(A,{children:[e.jsxs(M,{onSubmit:B,children:[e.jsxs(r,{className:"mb-3",children:[e.jsx(c,{htmlFor:"societyId",className:"col-sm-2 col-form-label",children:"Society"}),e.jsx(o,{sm:10,children:e.jsxs(j,{id:"societyId",name:"societyId",value:l.societyId,onChange:v,children:[e.jsx("option",{value:"",children:"Select Society"}),f.map(t=>e.jsx("option",{value:t._id,children:t.name},t._id))]})})]}),e.jsxs(r,{className:"mb-3",children:[e.jsx(c,{htmlFor:"blockId",className:"col-sm-2 col-form-label",children:"Block"}),e.jsx(o,{sm:10,children:e.jsxs(j,{id:"blockId",name:"blockId",value:l.blockId,onChange:I,disabled:!m,children:[e.jsx("option",{value:"",children:"Select Block"}),S.map(t=>e.jsx("option",{value:t._id,children:t.name},t._id))]})})]}),e.jsxs(r,{className:"mb-3",children:[e.jsx(c,{htmlFor:"name",className:"col-sm-2 col-form-label",children:"House Number"}),e.jsx(o,{sm:10,children:e.jsx(n,{type:"text",id:"name",name:"name",placeholder:"House Number",value:l.name,onChange:i,required:!0})})]}),e.jsxs(r,{className:"mb-3",children:[e.jsx(c,{htmlFor:"totalMembers",className:"col-sm-2 col-form-label",children:"Type"}),e.jsx(o,{sm:10,children:e.jsx(n,{type:"text",id:"type",name:"type",value:l.type,placeholder:"House Type like 2BHK, 3BHK",onChange:i,required:!0})})]}),e.jsxs(r,{className:"mb-3",children:[e.jsx(c,{htmlFor:"totalMembers",className:"col-sm-2 col-form-label",children:"Total Members"}),e.jsx(o,{sm:10,children:e.jsx(n,{type:"text",id:"totalMembers",name:"totalMembers",value:l.totalMembers,placeholder:"Total Members",onChange:i,required:!0})})]}),e.jsxs(r,{className:"mb-3",children:[e.jsx(c,{htmlFor:"totalChildren",className:"col-sm-2 col-form-label",children:"Total Children"}),e.jsx(o,{sm:10,children:e.jsx(n,{type:"text",id:"totalChildren",name:"totalChildren",value:l.totalChildren,placeholder:"Total Children",onChange:i,required:!0})})]}),e.jsxs(r,{className:"mb-3",children:[e.jsx(c,{htmlFor:"totalAdults",className:"col-sm-2 col-form-label",children:"Total Adults"}),e.jsx(o,{sm:10,children:e.jsx(n,{type:"text",id:"totalAdults",name:"totalAdults",value:l.totalAdults,placeholder:"Total Adults",onChange:i,required:!0})})]}),e.jsx(w,{type:"submit",color:"primary",children:"Submit"})]}),u&&e.jsx(C,{color:"danger",className:"mt-3",children:u}),b&&e.jsx(C,{color:"success",className:"mt-3",children:"Block created successfully!"})]})]})})})};export{J as default};
