import{v as I,r as a,j as e}from"./index-BOQoDeiJ.js";import{v as Z,g as H,a as O,b as k,u as G}from"./SocietyService-CGeiqU4x.js";import{C as o,a as l}from"./CRow-DZKMKKzZ.js";import{C as J,a as K}from"./CCardBody-Dm0V9Iwv.js";import{C as M}from"./CCardHeader-C3St3R9K.js";import{C as Q}from"./CForm-BmkLFAKO.js";import{a as c,C as i}from"./CFormInput-kvLYk_aa.js";import{C as x}from"./CFormSelect-B18wGbu2.js";import{C as V}from"./CImage-HSBO8RvM.js";import{a as W}from"./index.esm-BDIoaTPO.js";import{C as v}from"./CAlert-Bm5RWCiZ.js";import"./cil-user-CBnTYt-8.js";const ie=()=>{const{id:j}=I(),[r,m]=a.useState({name:"",street:"",locality:"",city:"",state:"",country:"",zipCode:"",establishment:"",type:"",logo:null,registrationNumber:""}),[p,y]=a.useState(null),[F,d]=a.useState(!1),[g,E]=a.useState(null),[L,w]=a.useState([]),[R,f]=a.useState([]),[D,C]=a.useState([]),[h,b]=a.useState(""),[u,S]=a.useState(""),[X,N]=a.useState("");a.useState(null);const q=async()=>{try{const s=await Z(j);if(s.code===200&&!s.error){const t=s.results,B={...t.settings,...t};m(B),b(t.country),S(t.state),N(t.city),setLogoPreview(t.settings.logo)}}catch(s){console.error("Failed to fetch society details:",s)}};a.useEffect(()=>{q()},[j]),a.useEffect(()=>{(async()=>{try{const t=await H();t.code===200&&!t.error?w(t.results):console.error("Error fetching countries:",t.message)}catch(t){console.error("Error fetching countries:",t)}})()},[]),a.useEffect(()=>{(async()=>{if(h)try{const t=await O(h);t.code===200&&!t.error?f(t.results):console.error("Error fetching states:",t.message)}catch(t){console.error("Error fetching states:",t)}else f([])})()},[h]),a.useEffect(()=>{(async()=>{if(u)try{const t=await k(u);t.code===200&&!t.error?C(t.results):console.error("Error fetching city:",t.message)}catch(t){console.error("Error fetching city:",t)}else C([])})()},[u]);const n=s=>{m({...r,[s.target.name]:s.target.value})},z=s=>{b(s.target.value),m({...r,[s.target.name]:s.target.value})},P=s=>{S(s.target.value),m({...r,[s.target.name]:s.target.value})},A=s=>{N(s.target.value),m({...r,[s.target.name]:s.target.value})},T=s=>{const t=s.target.files[0];m({...r,logo:t}),E(URL.createObjectURL(t))},U=async s=>{s.preventDefault(),y(null),d(!1);try{const t=await G(j,r);t.code===200&&!t.error?d(!0):(y(t.message),d(!1))}catch{y("Failed to edit society. Please try again."),d(!1)}};return e.jsx(o,{children:e.jsx(l,{xs:12,children:e.jsxs(J,{className:"mb-4",children:[e.jsx(M,{children:e.jsx("strong",{children:"Edit Society"})}),e.jsxs(K,{children:[e.jsxs(Q,{onSubmit:U,children:[e.jsxs(o,{className:"mb-3",children:[e.jsx(c,{htmlFor:"name",className:"col-sm-2 col-form-label",children:"Society Name"}),e.jsx(l,{sm:10,children:e.jsx(i,{type:"text",id:"name",name:"name",placeholder:"Society Name",value:r.name,onChange:n,required:!0})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(c,{htmlFor:"street",className:"col-sm-2 col-form-label",children:"Address Line 1"}),e.jsx(l,{sm:10,children:e.jsx(i,{type:"text",id:"street",name:"street",value:r.street,placeholder:"Address Line 1",onChange:n,required:!0})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(c,{htmlFor:"locality",className:"col-sm-2 col-form-label",children:"Locality"}),e.jsx(l,{sm:10,children:e.jsx(i,{type:"text",id:"locality",name:"locality",value:r.locality,placeholder:"Locality",onChange:n,required:!0})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(c,{htmlFor:"country",className:"col-sm-2 col-form-label",children:"Country"}),e.jsx(l,{sm:10,children:e.jsxs(x,{id:"country",name:"country",value:r.country,onChange:z,children:[e.jsx("option",{value:"",children:"Select Country"}),L.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(c,{htmlFor:"state",className:"col-sm-2 col-form-label",children:"State"}),e.jsx(l,{sm:10,children:e.jsxs(x,{id:"state",name:"state",value:r.state,onChange:P,disabled:!h,children:[e.jsx("option",{value:"",children:"Select State"}),R.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(c,{htmlFor:"city",className:"col-sm-2 col-form-label",children:"City"}),e.jsx(l,{sm:10,children:e.jsxs(x,{id:"city",name:"city",value:r.city,onChange:A,disabled:!u,children:[e.jsx("option",{value:"",children:"Select City"}),D.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(c,{htmlFor:"zipCode",className:"col-sm-2 col-form-label",children:"Zip code"}),e.jsx(l,{sm:10,children:e.jsx(i,{type:"tel",id:"zipCode",name:"zipCode",placeholder:"Zip Code",value:r.zipCode,onChange:n,required:!0})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(c,{htmlFor:"establishment",className:"col-sm-2 col-form-label",children:"Establishment Date"}),e.jsx(l,{sm:10,children:e.jsx(i,{type:"Date",id:"establishment",name:"establishment",placeholder:"Establishment Date",value:r.establishment,onChange:n})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(c,{htmlFor:"type",className:"col-sm-2 col-form-label",children:"Society Type"}),e.jsx(l,{sm:10,children:e.jsxs(x,{id:"type",name:"type",value:r.type,onChange:n,children:[e.jsx("option",{value:"",children:"Select Society Type"}),e.jsx("option",{value:"1",children:"Tenament"},"1"),e.jsx("option",{value:"2",children:"Flat"},"2")]})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(c,{htmlFor:"registrationNumber",className:"col-sm-2 col-form-label",children:"Registration Number"}),e.jsx(l,{sm:10,children:e.jsx(i,{type:"text",id:"registrationNumber",name:"registrationNumber",placeholder:"Registration Number",value:r.registrationNumber,onChange:n})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(c,{htmlFor:"logo",className:"col-sm-2 col-form-label",children:"Logo"}),e.jsx(l,{sm:10,children:e.jsx(i,{type:"file",id:"logo",name:"logo",onChange:T,accept:"image/*"})})]}),g&&e.jsxs(o,{className:"mb-3",children:[e.jsx(l,{sm:2}),e.jsx(l,{sm:10,children:e.jsx(V,{src:g,alt:"Logo Preview",width:200,className:"mb-2"})})]}),e.jsx(W,{type:"submit",color:"primary",children:"Submit"})]}),p&&e.jsx(v,{color:"danger",className:"mt-3",children:p}),F&&e.jsx(v,{color:"success",className:"mt-3",children:"Society updated successfully!"})]})]})})})};export{ie as default};
