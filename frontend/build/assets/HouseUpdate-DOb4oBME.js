import{b as A,r as l,j as e}from"./index-DnRDX3w2.js";import{v as M,g as T,a as _,u as w}from"./HouseService-DdV0A_2O.js";import{C as o,a as c}from"./CRow-1tTMpDHO.js";import{C as D,a as R}from"./CCardBody-DCdMFWZv.js";import{C as K}from"./CCardHeader-D4DRa4G8.js";import{C as L}from"./CForm-DUZMZWxx.js";import{a as i,C as d}from"./CFormInput-DldqsSPp.js";import{C as y}from"./CFormSelect-WBlYwP5F.js";import{b as O}from"./index.esm-DBaUAKo-.js";import{C as S}from"./CAlert-F9qhzg3x.js";import"./CCloseButton-DW2grjsO.js";const ee=()=>{const{id:u}=A(),[r,x]=l.useState({name:"",type:"",totalMembers:0,totalChildren:0,totalAdults:0,blockId:"",societyId:""}),[p,f]=l.useState(null),[g,j]=l.useState(!1),[N,v]=l.useState([]),[m,b]=l.useState(""),[k,I]=l.useState([]),[P,C]=l.useState(""),[F,h]=l.useState(!1),q=async()=>{try{const s=await M(u);if(s.code===200&&!s.error){const t=s.results;Object.keys(r).forEach(a=>{r[a]=t[a],a==="societyId"&&(r[a]=t[a]._id),a==="blockId"&&(r[a]=t[a]._id)}),b(t.societyId._id),C(t.blockId._id)}else console.error("Failed to fetch house details:".response.message)}catch(s){console.error("Failed to fetch house details:",s)}};l.useEffect(()=>{q()},[u]),l.useEffect(()=>{(async()=>{try{const t=await T();t.code===200&&!t.error?v(t.results):console.error("Error fetching societies:",t.error)}catch(t){console.error("Error fetching societies:",t)}})()},[]),l.useEffect(()=>{(async()=>{if(m)try{const t=await _(m);t.code===200&&!t.error?I(t.results):console.error("Error fetching blocks:",t.error)}catch(t){console.error("Error fetching blocks:",t)}})()},[m]);const n=s=>{x({...r,[s.target.name]:s.target.value})},B=s=>{b(s.target.value),x({...r,[s.target.name]:s.target.value})},E=s=>{C(s.target.value),x({...r,[s.target.name]:s.target.value})},H=async s=>{s.preventDefault(),f(null),j(!1),h(!0);try{const t=await w(u,r);t.code===200&&!t.error?(j(!0),h(!1)):(f(t.message),h(!1))}catch(t){f(t.response.data.errors),h(!1)}};return e.jsx(o,{children:e.jsx(c,{xs:12,children:e.jsxs(D,{className:"mb-4",children:[e.jsx(K,{children:e.jsx("strong",{children:"Edit House"})}),e.jsxs(R,{children:[e.jsxs(L,{onSubmit:H,children:[e.jsxs(o,{className:"mb-3",children:[e.jsxs(i,{htmlFor:"societyId",className:"col-sm-2 col-form-label",children:["Society ",e.jsx("span",{className:"required-asterisk",children:"*"})]}),e.jsx(c,{sm:10,children:e.jsxs(y,{id:"societyId",name:"societyId",value:r.societyId,onChange:B,children:[e.jsx("option",{value:"",children:"Select Society"}),N.map(s=>e.jsx("option",{value:s._id,children:s.name},s._id))]})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsxs(i,{htmlFor:"blockId",className:"col-sm-2 col-form-label",children:["Block ",e.jsx("span",{className:"required-asterisk",children:"*"})]}),e.jsx(c,{sm:10,children:e.jsxs(y,{id:"blockId",name:"blockId",value:r.blockId,onChange:E,disabled:!m,children:[e.jsx("option",{value:"",children:"Select Block"}),k.map(s=>e.jsx("option",{value:s._id,children:s.name},s._id))]})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsxs(i,{htmlFor:"name",className:"col-sm-2 col-form-label",children:["House Number ",e.jsx("span",{className:"required-asterisk",children:"*"})]}),e.jsx(c,{sm:10,children:e.jsx(d,{type:"text",id:"name",name:"name",placeholder:"House Number",value:r.name,onChange:n,required:!0})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsxs(i,{htmlFor:"totalMembers",className:"col-sm-2 col-form-label",children:["Type ",e.jsx("span",{className:"required-asterisk",children:"*"})]}),e.jsx(c,{sm:10,children:e.jsx(d,{type:"text",id:"type",name:"type",value:r.type,placeholder:"House Type like 2BHK, 3BHK",onChange:n,required:!0})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(i,{htmlFor:"totalMembers",className:"col-sm-2 col-form-label",children:"Total Members"}),e.jsx(c,{sm:10,children:e.jsx(d,{type:"text",id:"totalMembers",name:"totalMembers",value:r.totalMembers,placeholder:"Total Members",onChange:n,required:!0})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(i,{htmlFor:"totalChildren",className:"col-sm-2 col-form-label",children:"Total Children"}),e.jsx(c,{sm:10,children:e.jsx(d,{type:"text",id:"totalChildren",name:"totalChildren",value:r.totalChildren,placeholder:"Total Children",onChange:n,required:!0})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(i,{htmlFor:"totalAdults",className:"col-sm-2 col-form-label",children:"Total Adults"}),e.jsx(c,{sm:10,children:e.jsx(d,{type:"text",id:"totalAdults",name:"totalAdults",value:r.totalAdults,placeholder:"Total Adults",onChange:n,required:!0})})]}),e.jsx(O,{type:"submit",color:"primary",disabled:F,children:"Submit"})]}),p&&e.jsx(S,{color:"danger",className:"mt-3",children:p}),g&&e.jsx(S,{color:"success",className:"mt-3",children:"House updated successfully!"})]})]})})})};export{ee as default};
