import{a as Z,r,j as e}from"./index-BDq0fJeC.js";import{v as H,g as O,a as G,b as J,u as K}from"./SocietyService-isI-FQWX.js";import{C as o,a as l}from"./CRow-BptM8iaF.js";import{C as M,a as Q}from"./CCardBody-DX8udb6o.js";import{C as V}from"./CCardHeader-CErCK7DV.js";import{C as W}from"./CForm-aEcGfKVU.js";import{a as c,C as n}from"./CFormInput-vW0qYZpN.js";import{C as j}from"./CFormSelect-CfWV5T9u.js";import{C as X}from"./CImage-BW_azUiP.js";import{b as Y}from"./MemberDetailsView-BIJ5TZkK.js";import{C as F}from"./CAlert-B2xPzP-d.js";import"./cil-user-CgMK_sKB.js";const de=()=>{const{id:p}=Z(),[a,m]=r.useState({name:"",street:"",locality:"",city:"",state:"",country:"",zipCode:"",establishment:"",type:"",logo:null,registrationNumber:""}),[f,y]=r.useState(null),[E,d]=r.useState(!1),[g,q]=r.useState(null),[L,w]=r.useState([]),[D,C]=r.useState([]),[k,b]=r.useState([]),[h,N]=r.useState(""),[u,S]=r.useState(""),[_,v]=r.useState("");r.useState(null);const[R,x]=r.useState(!1),z=async()=>{try{const s=await H(p);if(s.code===200&&!s.error){const t=s.results,B={...t.settings,...t};m(B),N(t.country),S(t.state),v(t.city),setLogoPreview(t.settings.logo)}}catch(s){console.error("Failed to fetch society details:",s)}};r.useEffect(()=>{z()},[p]),r.useEffect(()=>{(async()=>{try{const t=await O();t.code===200&&!t.error?w(t.results):console.error("Error fetching countries:",t.message)}catch(t){console.error("Error fetching countries:",t)}})()},[]),r.useEffect(()=>{(async()=>{if(h)try{const t=await G(h);t.code===200&&!t.error?C(t.results):console.error("Error fetching states:",t.message)}catch(t){console.error("Error fetching states:",t)}else C([])})()},[h]),r.useEffect(()=>{(async()=>{if(u)try{const t=await J(u);t.code===200&&!t.error?b(t.results):console.error("Error fetching city:",t.message)}catch(t){console.error("Error fetching city:",t)}else b([])})()},[u]);const i=s=>{m({...a,[s.target.name]:s.target.value})},P=s=>{N(s.target.value),m({...a,[s.target.name]:s.target.value})},A=s=>{S(s.target.value),m({...a,[s.target.name]:s.target.value})},I=s=>{v(s.target.value),m({...a,[s.target.name]:s.target.value})},T=s=>{const t=s.target.files[0];m({...a,logo:t}),q(URL.createObjectURL(t))},U=async s=>{s.preventDefault(),x(!0),y(null),d(!1);try{const t=await K(p,a);t.code===200&&!t.error?(d(!0),x(!1)):(y(t.message),d(!1),x(!1))}catch(t){y(t.response.data.errors),d(!1),x(!1)}};return e.jsx(o,{children:e.jsx(l,{xs:12,children:e.jsxs(M,{className:"mb-4",children:[e.jsx(V,{children:e.jsx("strong",{children:"Edit Society"})}),e.jsxs(Q,{children:[e.jsxs(W,{onSubmit:U,children:[e.jsxs(o,{className:"mb-3",children:[e.jsxs(c,{htmlFor:"name",className:"col-sm-2 col-form-label",children:["Society Name ",e.jsx("span",{className:"required-asterisk",children:"*"})]}),e.jsx(l,{sm:10,children:e.jsx(n,{type:"text",id:"name",name:"name",placeholder:"Society Name",value:a.name,onChange:i,required:!0})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsxs(c,{htmlFor:"street",className:"col-sm-2 col-form-label",children:["Address Line 1 ",e.jsx("span",{className:"required-asterisk",children:"*"})]}),e.jsx(l,{sm:10,children:e.jsx(n,{type:"text",id:"street",name:"street",value:a.street,placeholder:"Address Line 1",onChange:i,required:!0})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsxs(c,{htmlFor:"locality",className:"col-sm-2 col-form-label",children:["Locality ",e.jsx("span",{className:"required-asterisk",children:"*"})]}),e.jsx(l,{sm:10,children:e.jsx(n,{type:"text",id:"locality",name:"locality",value:a.locality,placeholder:"Locality",onChange:i,required:!0})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsxs(c,{htmlFor:"country",className:"col-sm-2 col-form-label",children:["Country ",e.jsx("span",{className:"required-asterisk",children:"*"})]}),e.jsx(l,{sm:10,children:e.jsxs(j,{id:"country",name:"country",value:a.country,onChange:P,children:[e.jsx("option",{value:"",children:"Select Country"}),L.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsxs(c,{htmlFor:"state",className:"col-sm-2 col-form-label",children:["State ",e.jsx("span",{className:"required-asterisk",children:"*"})]}),e.jsx(l,{sm:10,children:e.jsxs(j,{id:"state",name:"state",value:a.state,onChange:A,disabled:!h,children:[e.jsx("option",{value:"",children:"Select State"}),D.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsxs(c,{htmlFor:"city",className:"col-sm-2 col-form-label",children:["City ",e.jsx("span",{className:"required-asterisk",children:"*"})]}),e.jsx(l,{sm:10,children:e.jsxs(j,{id:"city",name:"city",value:a.city,onChange:I,disabled:!u,children:[e.jsx("option",{value:"",children:"Select City"}),k.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsxs(c,{htmlFor:"zipCode",className:"col-sm-2 col-form-label",children:["Zip code ",e.jsx("span",{className:"required-asterisk",children:"*"})]}),e.jsx(l,{sm:10,children:e.jsx(n,{type:"tel",id:"zipCode",name:"zipCode",placeholder:"Zip Code",value:a.zipCode,onChange:i,required:!0})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(c,{htmlFor:"establishment",className:"col-sm-2 col-form-label",children:"Establishment Date"}),e.jsx(l,{sm:10,children:e.jsx(n,{type:"Date",id:"establishment",name:"establishment",placeholder:"Establishment Date",value:a.establishment,onChange:i})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsxs(c,{htmlFor:"type",className:"col-sm-2 col-form-label",children:["Society Type ",e.jsx("span",{className:"required-asterisk",children:"*"})]}),e.jsx(l,{sm:10,children:e.jsxs(j,{id:"type",name:"type",value:a.type,onChange:i,children:[e.jsx("option",{value:"",children:"Select Society Type"}),e.jsx("option",{value:"1",children:"Tenament"},"1"),e.jsx("option",{value:"2",children:"Flat"},"2")]})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(c,{htmlFor:"registrationNumber",className:"col-sm-2 col-form-label",children:"Registration Number"}),e.jsx(l,{sm:10,children:e.jsx(n,{type:"text",id:"registrationNumber",name:"registrationNumber",placeholder:"Registration Number",value:a.registrationNumber,onChange:i})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(c,{htmlFor:"logo",className:"col-sm-2 col-form-label",children:"Logo"}),e.jsx(l,{sm:10,children:e.jsx(n,{type:"file",id:"logo",name:"logo",onChange:T,accept:"image/*"})})]}),g&&e.jsxs(o,{className:"mb-3",children:[e.jsx(l,{sm:2}),e.jsx(l,{sm:10,children:e.jsx(X,{src:g,alt:"Logo Preview",width:200,className:"mb-2"})})]}),e.jsx(Y,{type:"submit",color:"primary",disabled:R,children:"Submit"})]}),f&&e.jsx(F,{color:"danger",className:"mt-3",children:f}),E&&e.jsx(F,{color:"success",className:"mt-3",children:"Society updated successfully!"})]})]})})})};export{de as default};
